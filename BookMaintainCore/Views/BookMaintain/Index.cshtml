<!-- 橫幅bar -->
<div class="row">
    <!-- bootstarp Carousel -->
    <div class="col-1"></div>
    <div class="col-10">
        <div id="carouselExampleCaptions" class="carousel slide" data-bs-ride="false">
            <div class="carousel-indicators">
                <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
                <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="1" aria-label="Slide 2"></button>
            </div>
            <div class="carousel-inner">
                <div class="carousel-item active">
                    <img src="\Img\cherry_blossoms.png" class="d-block w-100" alt="...">
                    <div class="carousel-caption d-none d-md-block">
                        <h5>美景祝福.</h5>
                        <p>大學時期APP的底圖.</p>
                    </div>
                </div>
                <div class="carousel-item">
                    <img src="\Img\input_bg.png" class="d-block w-100" alt="...">
                    <div class="carousel-caption d-none d-md-block">
                        <h5>APP店面.</h5>
                        <p>大學時期APP介面圖.</p>
                    </div>
                </div>
            </div>
            <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Previous</span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Next</span>
            </button>
        </div>
    </div>
    <div class="col-1"></div>
</div>


<div class="row">
    <!-- 動態添加會並排，精選文章 -->
    <div class="card-group">
        <div class="card">
            <img src="\Img\ic_launcher.png" style="width: 100px; height: 100px;" class="card-img-top" alt="食的道">
            <div class="card-body">
                <h5 class="card-title">道盡人生</h5>
                回鄉偶書<br>
                賀知章<br>
                離別家鄉歲月多，<br>
                近來人事半消磨。<br>
                唯有門前近水湖，<br>
                春風不改舊時波。<br>
                <a href="#" class="btn btn-primary">文章分析</a>
            </div>
            <div class="card-footer">
                <small class="text-muted">Last updated 3 mins ago</small>
            </div>
        </div>
        <div class="card">
            <img src="\Img\ic_launcher.png" style="width: 100px; height: 100px;" class="card-img-top" alt="食的道">
            <div class="card-body">
                <h5 class="card-title">道盡人生</h5>
                回鄉偶書<br>
                賀知章<br>
                離別家鄉歲月多，<br>
                近來人事半消磨。<br>
                唯有門前近水湖，<br>
                春風不改舊時波。<br>
                <a href="#" class="btn btn-primary">文章分析</a>
            </div>
            <div class="card-footer">
                <small class="text-muted">Last updated 3 mins ago</small>
            </div>
        </div>
        <div class="card">
            <img src="\Img\ic_launcher.png" style="width: 100px; height: 100px;" class="card-img-top" alt="食的道">
            <div class="card-body">
                <h5 class="card-title">道盡人生</h5>
                回鄉偶書<br>
                賀知章<br>
                離別家鄉歲月多，<br>
                近來人事半消磨。<br>
                唯有門前近水湖，<br>
                春風不改舊時波。<br>
                <a href="#" class="btn btn-primary">文章分析</a>
            </div>
            <div class="card-footer">
                <small class="text-muted">Last updated 3 mins ago</small>
            </div>
        </div>
    </div>

    <!--
    <div class="col-4">
        <div class="card" style="width: 18rem;">
            <img src="\Img\ic_launcher.png" style="width: 100px; height: 100px;" class="card-img-top" alt="食的道">
            <div class="card-body">
                <h5 class="card-title">道盡人生</h5>
                回鄉偶書<br>
                賀知章<br>
                離別家鄉歲月多，<br>
                近來人事半消磨。<br>
                唯有門前近水湖，<br>
                春風不改舊時波。<br>
                <a href="#" class="btn btn-primary">文章分析</a>
            </div>
        </div>
    </div>
    -->
    @Html.AntiForgeryToken()
</div>

<div class="row">
    <div class="col-12">
        <div class="accordion" id="accordionExample">
            <div class="accordion-item">
                <h2 class="accordion-header" id="headingOne">
                    <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-book" viewBox="0 0 16 16">
                            <path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z" />
                        </svg>
                        食的道 #1
                    </button>
                </h2>
                <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne" data-bs-parent="#accordionExample">
                    <div class="accordion-body">
                        <h3>天之食道</h3>
                        <span class="badge bg-primary rounded-pill">第14集</span>
                        <small>3 天以前</small>
                        <hr />
                        <strong>This is the first item's accordion body.</strong> <code>這是我想注意的點</code>, until the collapse plugin adds the appropriate classes that we use to style each element. These classes control the overall appearance, as well as the showing and hiding via CSS transitions. You can modify any of this with custom CSS or overriding our default variables. It's also worth noting that just about any HTML can go within the <code>.accordion-body</code>, though the transition does limit overflow.
                        <hr />
                        <div class="row justify-content-between">
                            <div class="row">
                                <div class="col-auto me-auto">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-person-fill" viewBox="0 0 16 16">
                                        <path d="M3 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H3zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6z" />
                                    </svg>
                                    開發使用者
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-watch" viewBox="0 0 16 16">
                                        <path d="M8.5 5a.5.5 0 0 0-1 0v2.5H6a.5.5 0 0 0 0 1h2a.5.5 0 0 0 .5-.5V5z" />
                                        <path d="M5.667 16C4.747 16 4 15.254 4 14.333v-1.86A5.985 5.985 0 0 1 2 8c0-1.777.772-3.374 2-4.472V1.667C4 .747 4.746 0 5.667 0h4.666C11.253 0 12 .746 12 1.667v1.86a5.99 5.99 0 0 1 1.918 3.48.502.502 0 0 1 .582.493v1a.5.5 0 0 1-.582.493A5.99 5.99 0 0 1 12 12.473v1.86c0 .92-.746 1.667-1.667 1.667H5.667zM13 8A5 5 0 1 0 3 8a5 5 0 0 0 10 0z" />
                                    </svg>
                                    開發時間
                                </div>
                                <div class="col-auto"> <button type="button" class="btn btn-primary">前往全文</button></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="accordion-item">
                <h2 class="accordion-header" id="headingTwo">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-book" viewBox="0 0 16 16">
                            <path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783z" />
                        </svg>
                        食的道 #2
                    </button>
                </h2>
                <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#accordionExample">
                    <div class="accordion-body">
                        <h3>天之食道</h3>
                        <hr />
                        <strong>This is the second item's accordion body.</strong> It is hidden by default, until the collapse plugin adds the appropriate classes that we use to style each element. These classes control the overall appearance, as well as the showing and hiding via CSS transitions. You can modify any of this with custom CSS or overriding our default variables. It's also worth noting that just about any HTML can go within the <code>.accordion-body</code>, though the transition does limit overflow.
                        <hr />
                        <div class="row">
                            <div class="col-auto me-auto">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-person-fill" viewBox="0 0 16 16">
                                    <path d="M3 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H3zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6z" />
                                </svg>
                                開發使用者
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-watch" viewBox="0 0 16 16">
                                    <path d="M8.5 5a.5.5 0 0 0-1 0v2.5H6a.5.5 0 0 0 0 1h2a.5.5 0 0 0 .5-.5V5z" />
                                    <path d="M5.667 16C4.747 16 4 15.254 4 14.333v-1.86A5.985 5.985 0 0 1 2 8c0-1.777.772-3.374 2-4.472V1.667C4 .747 4.746 0 5.667 0h4.666C11.253 0 12 .746 12 1.667v1.86a5.99 5.99 0 0 1 1.918 3.48.502.502 0 0 1 .582.493v1a.5.5 0 0 1-.582.493A5.99 5.99 0 0 1 12 12.473v1.86c0 .92-.746 1.667-1.667 1.667H5.667zM13 8A5 5 0 1 0 3 8a5 5 0 0 0 10 0z" />
                                </svg>
                                開發時間
                            </div>
                            <div class="col-auto"> <button type="button" class="btn btn-primary">前往全文</button></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

    <div id="indexForm" class="row"></div>
    <div class="modal" tabindex="-1" id="alertModal"></div>
    <!-- windows用蓋的，有資料就重蓋 -->
    <div class="row">
        <div class="col-12">
            <div id="searchTable">
            </div>
        </div>
    </div>

    <div id="BookLendRecordWindow"><div id="bookLendRecordTbody"></div></div>

    <div>
        <!-- 因為頁面還有其他的元件，不要用頁面錯誤提示 -->
        <div class="text-bg-danger p-3" id="serch_error" style="">Danger with contrasting color</div>
    </div>
    <!-- Flexbox container for aligning the toasts -->
    <!--<div aria-live="polite" aria-atomic="true" class="d-flex justify-content-center align-items-center w-100">-->
    <!-- Then put toasts within -->
    <!--<div id="liveToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
            <div class="toast-header">
                <img src="..." class="rounded me-2" alt="...">
                <strong class="me-auto">Bootstrap</strong>
                <small>11 mins ago</small>
                <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
            </div>
            <div class="toast-body">
                Hello, world! This is a toast message.
            </div>
        </div>
    </div>-->
    <!---------------------------------------------------------------------------------------------------------------------------------浮動視窗-->
    <!--
    insert update 要上
    https://getbootstrap.com/docs/5.2/components/popovers/
    提示視窗
        https://getbootstrap.com/docs/5.2/components/toasts/
    -->
    <!-- Button trigger modal -->
    <!--
    <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#staticBackdrop">
        Launch static backdrop modal
    </button>
    -->
    <!-- Vertically centered scrollable modal -->
    <!--
    <div id="staticBackdrop" class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
        ...
    </div>
     -->
    <!--
    文章list
    https://getbootstrap.com/docs/5.2/components/spinners/
    Spinners
    -->
    <script>
        let myModal = {
            alertModal: null
        };

        let bootStarpTmp = {
            indexBookName: [],
            indexBookName2: {}
        };

        function initBeforeSearch() {
            //要刪除
            //get可能會有問題
            //const toast = new bootstrap.Toast($("#liveToast"));
            //toast.show()
            let alertObjet = [
                {
                    key: "alertModal",
                    title: "圖書維護錯誤提示",
                    objectName: "window",
                    template: '<p id="alertMessage"></p>',
                    button: {
                        button1: {
                            'type': "button",
                            'class': "btn btn-secondary",
                            'data_bs_dismiss': "modal",
                            'aria_label': "Close",
                            'text': "關閉"
                        },
                        button2: {
                            'type': "button",
                            'class': "btn btn-primary",
                            'data_bs_dismiss': "modal",
                            'aria_label': "Close",
                            'text': "我已了解"
                        },
                    }
                }
            ];
            createObjet(alertObjet);

            let indexFromObjet = [
                {
                    key: "indexBookName",
                    name: "BOOK_NAME",
                    link: "/BookMaintain/getFormInputData",
                    type: "text",
                    objectName: "autoComplete2",
                    placeholder: "書名 ...",
                    labelName: "書名",
                    data: {
                        'type': "bookName"
                    }
                },
                {
                    key: "indexBookClassId",
                    name: "BOOK_CLASS_ID",
                    type: "text",
                    link: "/BookMaintain/getFormSelectData",
                    objectName: "dropDownList",
                    labelName: "圖書類別",
                    data: {
                        'type': "bookClassIdText"
                    }
                },
                {
                    key: "indexUserId",
                    name: "BOOK_AUTHOR",
                    type: "text",
                    link: "/BookMaintain/getFormSelectData",
                    objectName: "dropDownList",
                    labelName: "借閱人",
                    data: {
                        'type': "userIdTextOri"
                    }
                },
                {
                    key: "indexCodeId",
                    name: "CodeId",
                    type: "text",
                    link: "/BookMaintain/getFormSelectData",
                    objectName: "dropDownList",
                    labelName: "借閱狀態",
                    data: {
                        'type': "codeIdText"
                    }
                },
                {
                    key: "getTableMainData",
                    labelName: "查詢",
                    objectName: "button",
                    class: "btn btn-secondary position-relative",
                    liKey: "indexFromButton",
                    //data與link需要一起使用，Bootstarp Badge
                    link: "/BookMaintain/getBookNumber",
                    data: {
                        'type': "newBook"
                    }
                },
                {
                    key: "removeTableData",
                    labelName: "清除",
                    objectName: "button",
                    class: "btn btn-secondary",
                    liKey: "indexFromButton"
                },
                {
                    key: "initInsert",
                    labelName: "新增",
                    objectName: "button",
                    class: "btn btn-secondary",
                    method: {
                        onclick: "javascript: location.href = '/BookMaintain/Insert'"
                    },
                    liKey: "indexFromButton"
                },
                {
                    key: "searchTable",
                    objectName: "table",
                    pageable: {
                        pageSize: 10,
                    },
                    columns: [
                        { field: "BOOK_ID", title: "圖書ID", width: "70px" },
                        { field: "BOOK_CLASS_NAME", title: "圖書類別", width: "100px" },
                        {
                            field: "BOOK_NAME", title: "書名", width: "150px", template: "<a href='javascript:void (0)' onclick='bookDetail(this);' style='color:blue'><u>${BOOK_NAME}</u></a>"
                        },
                        { field: "BOOK_BOUGHT_DATE", title: "購書日期", width: "140px", format: "{0: yyyy/MM/dd}" },
                        { field: "CODE_NAME", title: "借閱狀態", width: "130px" },
                        { field: "USER_ENAME", title: "借閱人", width: "90px" },
                        { field: "BOOK_AMOUNT", title: "書本數量", width: "100px", money: "origin" },
                        { command: { text: "借閱紀錄", click: getTableBookLendRecordData }, title: "借閱紀錄", width: "140px" },
                        { command: { text: "編輯", click: updateBookMaintain }, title: "編輯", width: "140px" },
                        { command: { text: "刪除", click: deleteBook }, title: "刪除", width: "140px" },
                    ]
                }
            ];
            //相關的資料可以丟localStorage，避免重複抓取
            createObjet(indexFromObjet, "indexForm");
            processObjet(indexFromObjet);
            //先寫丟到上方陣列()
            //$("#indexBookName").bind("keyup",function (e) {
            //可以抓找到的第一筆資料
            $("#indexBookName").keyup(function (e) {
                searchType = 3;
                //找單字
                switch (searchType) {
                    case 1:
                        console.log(e.currentTarget.value);
                        break;
                    case 2:
                        console.log(matche(e.currentTarget.value));
                        break;
                    case 3:
                        for (let tmp = 0; tmp < bootStarpTmp.indexBookName.length; tmp++) {
                            console.log(e.currentTarget.value.indexOf(bootStarpTmp.indexBookName[tmp]));
                            console.log(e.currentTarget.value);
                            console.log(bootStarpTmp.indexBookName[tmp]);
                            //為空判定會錯
                            if (bootStarpTmp.indexBookName[tmp] == "") {
                                break;
                            }
                            if (bootStarpTmp.indexBookName[tmp].indexOf(e.currentTarget.value) != -1) {
                                e.currentTarget.value = bootStarpTmp.indexBookName[tmp];
                                break;
                            }
                        }
                        break;
                    case 4:
                        console.log(search(e.currentTarget.value));
                        break;
                }
            });

            //要改道寫進去創建
            $("#removeTableData").click(function (e) {
                deleteAllGrid("searchTable", "clearAll");
            });
            //要改道寫進去創建
            $("#getTableMainData").click(function (e) {

                let data = {};
                if ($("#indexBookName").val() != "") {
                    data['BOOK_NAME'] = $("#indexBookName").val();
                }

                if ($("#indexBookClassId").val() != "") {
                    data['BOOK_CLASS_ID'] = $("#indexBookClassId").val();
                }

                if ($("#indexUserId").val() != "") {
                    data['USER_ID'] = $("#indexUserId").val();
                }

                if ($("#indexCodeId").val() != "") {
                    data['CODE_ID'] = $("#indexCodeId").val();
                }

                data['pageSize'] = 10;

                //template 應該要掛上去最後在刪掉
                getDataSource("/BookMaintain/getTableMainData", "searchTable", data, {
                    key: "searchTable",
                    objectName: "table",
                    pageable: {
                        pageSize: 10,
                    },
                    columns: [
                        { field: "booK_ID", title: "圖書ID", width: "70px" },
                        { field: "booK_CLASS_NAME", title: "圖書類別", width: "100px" },
                        {
                            field: "booK_NAME", title: "書名", width: "150px", template: "<a href='javascript:void (0)' onclick='bookDetail(this);' style='color:blue'><u>${booK_NAME}</u></a>"
                        },
                        { field: "booK_BOUGHT_DATE", title: "購書日期", width: "140px", format: "{0: yyyy/MM/dd}" },
                        { field: "codE_NAME", title: "借閱狀態", width: "130px" },
                        { field: "useR_ENAME", title: "借閱人", width: "90px" },
                        { field: "booK_AMOUNT", title: "書本數量", width: "100px", money: "origin" },
                        { command: { text: "借閱紀錄", click: getTableBookLendRecordData }, title: "借閱紀錄", width: "140px", class: "btn btn-secondary" },
                        { command: { text: "編輯", click: updateBookMaintain }, title: "編輯", width: "140px", class: "btn btn-secondary" },
                        { command: { text: "刪除", click: deleteBook }, title: "刪除", width: "140px", class: "btn btn-secondary" },
                    ]
                });
            });

        }

        function getTableBookLendRecordData() {

        }

        function updateBookMaintain(buttonObj) {
            //localStorage換頁
            /*
            json = {};
            json['BOOK_ID'] = $(buttonObj.currentTarget.closest("tr"))[0].childNodes[0].innerText;
            localStorage.setItem('BOOK_DATA', json);
            location.href = '/BookMaintain/Update';
            */

            //$(buttonObj.currentTarget.closest("tr"));
            //getDataSource('/BookMaintain/Update', "updateData", json, null)
        }

        //不能放到common內去
        function deleteBook(buttonObj) {
            $(buttonObj.currentTarget.closest("tr")).remove();
        }

        initBeforeSearch();
    </script>
