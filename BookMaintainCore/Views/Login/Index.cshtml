<!-- 參考Floating labels -->
<!-- 驗證搭配<div class="text-bg-danger p-3" id="serch_error" style="">Danger with contrasting color</div> -->
<!-- Bootstarp Collapse is-invalid is-valid -->
<div class="row">
    <div class="text-bg-secondary p-3" id="serch_error" style="">登入頁面</div>
</div>


<form id="loginForm" class="was-validated">
    <div class="mb-3">
        <label for="floatingInputInvalid" class="form-label">信箱帳號</label>
        <input type="text" class="form-control" id="floatingInputInvalid" placeholder="name@example.com" required>
        <div class="invalid-feedback">
            請輸入信箱帳號
        </div>
    </div>
    <div class="mb-3">
        <label for="floatingInputInvalid2" class="form-label">密碼</label>
        <input type="text" class="form-control" id="floatingInputInvalid2" placeholder="********" required>
        <div class="invalid-feedback">
            請輸入密碼
        </div>
    </div>
    <div class="mb-3 form-floating">
        <input type="text" class="form-control" id="floatingInputInvalid3" placeholder="name@example.com">
        <label for="floatingInputInvalid3">機器型態</label>
    </div>
    <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" name="inlineRadioOptions" id="inlineRadio1" value="option1">
        <label class="form-check-label" for="inlineRadio1">記住我</label>
    </div>
    <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" name="inlineRadioOptions" id="inlineRadio2" value="option2">
        <label class="form-check-label" for="inlineRadio2">不記住我</label>
    </div>
    <input type="text" name="code" value=@ViewBag.code />
    <img id="code" src="/backend/Login/GetValidateCode?loginCode=@ViewBag.code" />
    <!-- 需要移到到後台admin -->
    <!--
    <div class="alert alert-success" role="alert">
        <h4 class="alert-heading">Well done!</h4>
        <p>Aww yeah, you successfully read this important alert message. This example text is going to run a bit longer so that you can see how spacing within an alert works with this kind of content.</p>
        <hr>
        <p class="mb-0">Whenever you need to, be sure to use margin utilities to keep things nice and tidy.</p>
    </div>
    -->
    @Html.AntiForgeryToken()

    <!-- 需要時動態產生在div中
    <div id="liveAlertPlaceholder">
        <div>
            <div class="alert alert-success alert-dismissible" role="alert">
                <div>Nice, you triggered this alert message!</div>
                <button type="button"
                        class="btn-close"
                        data-bs-dismiss="alert"
                        aria-label="Close"></button>
            </div>
        </div>
    </div>
    -->
</form>
<button type="button" class="btn btn-primary" id="liveAlertBtn" onclick="login();">
    送出
</button>

<!--
<div class="row">
    <div id="transferForm" class="row"></div>
</div>
<div class="modal" tabindex="-1" id="alertModal"></div>
<div class="modal" tabindex="-1" id="loginCheckModal"></div>
-->
<!--
    如果帳號打對了，就先所帳號
<input class="form-control" type="text" value="Disabled readonly input" aria-label="Disabled input example" disabled readonly>
-->
<script>
    function determineLoginType() {
        if (navigator.userAgent.match(/Android/i)
            || navigator.userAgent.match(/webOS/i)
            || navigator.userAgent.match(/iPhone/i)
            || navigator.userAgent.match(/iPad/i)
            || navigator.userAgent.match(/iPod/i)
            || navigator.userAgent.match(/BlackBerry/i)
            || navigator.userAgent.match(/Windows Phone/i)
        ) {
            return 'PhoneLoginState';
        }
        else {
            return 'WebLoginState';
        }

        /*navigator.userAgent.match("Firefox")　//判斷是否為 FireFox
        navigator.userAgent.match("MSIE")　//判斷是否為 IE
        navigator.userAgent.match("Opera")　//判斷是否為 Opera
        navigator.userAgent.match("Safari")　//判斷是否為 Safari 或 Google Chrome目前沒有方法*/
    }
    console.log(determineLoginType());
    document.getElementById('floatingInputInvalid3').value = determineLoginType();

    function login(){
        let json = new FormData();
        json.append('Email', document.getElementById('floatingInputInvalid').value);
        json.append('Password', document.getElementById('floatingInputInvalid2').value);
        json.append('MachineType', document.getElementById('floatingInputInvalid3').value);
        console.log(document.getElementById('floatingInputInvalid3').value);
        console.log(json);
        $.ajax({
            type: "post",
            url: "/backend/Login/Insert",
            data: json,
            headers: { "__RequestVerificationToken": $("input[name='__RequestVerificationToken']").val() },
            processData: false, // important// 告訴jquery不要去處理發送的數據
            contentType: false, // important// 告訴Jquery不要去設定Content-type請求頭
            mimeType: 'multipart/form-data',
            //dataType: "json",
            success: function (successData) {
                console.log(successData);
                successData = JSON.parse(successData);
                if (successData.message == "登入成功") {
                    console.log(successData);
                    location.href = "/BookMaintain/Index";
                } else {
                    //ajaxBSError(successData);
                    alert(successData.message);
                }
            },
            error: function (error) {
                //ajaxBSError(error);
                alert(error);
            }
        });
    }
    /*let myModal = {
        alertModal: null,
        loginCheckModal: null
    };

    let alertObjet = [
        {
            key: "alertModal",
            title: "圖書維護提示",
            objectName: "window",
            template: '<p id="alertMessage"></p>',
            button: {
                button1: {
                    'type': "button",
                    'class': "btn btn-secondary",
                    'data_bs_dismiss': "modal",
                    'aria_label': "Close",
                    'text': "關閉"
                },
                button2: {
                    'type': "button",
                    'class': "btn btn-primary",
                    'data_bs_dismiss': "modal",
                    'aria_label': "Close",
                    'text': "我已了解"
                },
            }
        },
        {
            key: "loginCheckModal",
            title: "確認送出",
            objectName: "window",
            template: '<p id="registerCheckMessage">確定送出</p>',
            button: {
                button1: {
                    'type': "button",
                    'class': "btn btn-secondary",
                    'data_bs_dismiss': "modal",
                    'aria_label': "Close",
                    'text': "關閉"
                },
                button2: {
                    'type': "button",
                    'class': "btn btn-primary",
                    'data_bs_dismiss': "modal",
                    'aria_label': "Close",
                    'text': "送出",
                    'method': {
                        onclick: 'implementAjax("/Login/Insert", "loginJson");'
                    }
                },
            }
        }
    ];
    createObjet(alertObjet);

    let registerFormObjet = [
        {
            key: "floatingEmail",
            name: "Email",
            objectName: "input",
            class: "form-control is-invalid",
            gropName: 'Email',
            placeholder: "name@example.com",
            type: "email",
            validation: {
                validationDiv: "mb-3 form-floating"
            },
            method: {
                onkeyup: 'validation2(floatingEmail);'
            }
        },
        {
            key: "floatingEmail",
            objectName: "lable2",
            labelName: "信箱帳號",
            gropName: 'Email'
        },
        {
            key: "floatingPassword",
            name: "Password",
            objectName: "input",
            class: "form-control is-invalid",
            gropName: 'Password',
            placeholder: "密碼",
            type: "password",
            validation: {
                validationDiv: "mb-3 form-floating"
            },
            method: {
                onkeyup: 'validation2(floatingPassword);'
            }
        },
        {
            key: "floatingPassword",
            objectName: "lable2",
            labelName: "密碼",
            gropName: 'Password'
        }
    ];
    createObjet(registerFormObjet, "loginForm");

    let returnFormObjet = [
        {
            labelName: "註冊",
            key: "getTableMainData",
            objectName: "button",
            class: "btn btn-secondary",
            method: {
                onclick: 'cangeUrl("/Register/Index");'
            },
            liKey: "loginFromButton"
        },
        {
            labelName: "送出",
            key: "initInsert",
            objectName: "button",
            class: "btn btn-secondary",
            method: {
                onclick: "validation([floatingEmail, floatingPassword]);",
            },
            liKey: "loginFromButton",
            modelName: "loginCheckModal"
        },
        {
            labelName: "忘記密碼",
            key: "getTableMainData",
            objectName: "button",
            class: "btn btn-secondary",
            method: {
                onclick: 'cangeUrl("/Login/ForgetPassword");'
            },
            liKey: "loginFromButton"
        },
    ]
    createObjet(returnFormObjet, "transferForm");*/
</script>
